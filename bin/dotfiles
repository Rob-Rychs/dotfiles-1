#!/usr/bin/env bash

if [[ -z "$1" || "$1" == "-h" || "$1" == "--help" ]]; then cat <<HELP
Dotfiles - Lars Graubner - http://larsgraubner.de

Usage: $(basename "$0") {install|update|upgrade}

See the README for documentation.
https://github.com/lgraubner/dotfiles

Copyright (c) 2015 Lars Graubner
Licensed under the MIT license.
HELP
exit; fi

export DOTFILES=~/.dotfiles

source $DOTFILES/scripts/utils.sh

install() {
    # find installers and run them iteratively
    find $DOTFILES -name install.sh | while read installer ; do sh -c "${installer}" ; done
}

update() {
    # find updaters and run them iteratively
    find $DOTFILES -name update.sh | while read updater ; do sh -c "${updater}" ; done
}

upgrade() {
    e_header "Upgrading dotfiles"

    cd $DOTFILES

    git checkout master
    git pull origin master

    e_success "dotfiles upgraded"
}

case $1 in
    install)
        install
        ;;
    update)
        update
        ;;
    upgrade)
        upgrade
        ;;
    *)
        exit 1
esac

e_header "All done!"
